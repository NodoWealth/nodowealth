<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Dashboard | Nodo</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
</head>
<body class="dashboard-layout">

    <header class="header-logado">
        <img src="logo_nodo.png" class="logo-mini">
        <div class="user-info">
            <span id="user-name">Carregando...</span>
            <button onclick="netlifyIdentity.logout()" class="btn-logout">Sair</button>
        </div>
    </header>

    <main class="container">
        <section class="welcome-header">
            <h1>Bem-vindo, <span class="bronze" id="display-name">Investidor</span></h1>
            <p>Seu resumo patrimonial de hoje.</p>
        </section>

        <div class="dashboard-grid">
            <div class="nav-card">
                <h3>Consolidador de Ativos</h3>
                <p>Acesse sua carteira completa e performance em tempo real.</p>
                <a href="consolidar.html" class="btn-outline">Abrir Ferramenta</a>
            </div>

            <div class="nav-card">
                <h3>Simulador de Juros</h3>
                <p>Projete o crescimento do seu legado para as próximas décadas.</p>
                <a href="simulador.html" class="btn-outline">Simular Agora</a>
            </div>

            <div class="nav-card">
                <h3>Research Premium</h3>
                <p>Relatórios exclusivos sobre o mercado e teses de investimento.</p>
                <a href="research.html" class="btn-outline">Ver Relatórios</a>
            </div>
        </div>
    </main>

    <script>
        // Lógica de Segurança
        function checkAuth() {
            const user = netlifyIdentity.currentUser();
            if (!user) {
                // Se não estiver logado, manda para a página de acesso
                window.location.href = "/acesso.html";
            } else {
                // Preenche o nome do usuário vindo do Netlify Identity
                const name = user.user_metadata.full_name || user.email;
                document.getElementById('user-name').innerText = name;
                document.getElementById('display-name').innerText = name.split(' ')[0];
            }
        }

        // Executa ao carregar e ao inicializar o widget
        netlifyIdentity.on('init', checkAuth);
        netlifyIdentity.on('logout', () => window.location.href = "/index.html");
    </script>
</body>
</html>